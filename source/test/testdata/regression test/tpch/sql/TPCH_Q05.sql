select n_name, sum(l_extendedprice * (1 - l_discount)) as revenue from customer JOIN orders ON (c_custkey = o_custkey) JOIN lineitem ON (o_orderkey = l_orderkey) JOIN supplier ON (l_suppkey = s_suppkey) JOIN (select * from nation JOIN region ON (n_regionkey = r_regionkey)) ON (s_nationkey = n_nationkey) where c_nationkey = s_nationkey and r_name = 'ASIA' and o_orderdate >= '1994-01-01' and o_orderdate < '1995-01-01' group by n_name order by revenue desc;
